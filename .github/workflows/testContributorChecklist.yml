name: "Contributor Checklist"

on:
  issue_comment:
    types: [created, edited]

jobs:
  checklist:
    runs-on: ubuntu-latest
    if: github.event.issue.pull_request
    steps:
      - uses: actions-ecosystem/action-regex-match@v2
        id: checklist
        with:
          text: ${{ github.event.comment.body }}
          regex: '\s\#\#\#\#\ Contributor\ \(PR\ Author\)\ Checklist\n-\ \[X]\ I\ linked\ the\ correct\ issue\ in\ the\ `\#\#\#\ Fixed\ Issues`\ section\ above\n-\ \[X]\ I\ wrote\ clear\ testing\ steps\ that\ cover\ the\ changes\ made\ in\ this\ PR\n\ \ \ \ -\ \[X]\ I\ added\ steps\ for\ local\ testing\ in\ the\ `Tests`\ section\n\ \ \ \ -\ \[X]\ I\ added\ steps\ for\ Staging\ and\/or\ Production\ testing\ in\ the\ `QA\ steps`\ section\n\ \ \ \ -\ \[X]\ I\ added\ steps\ to\ cover\ failure\ scenarios\ \(i\.e\.\ verify\ an\ input\ displays\ the\ correct\ error\ message\ if\ the\ entered\ data\ is\ not\ correct\)\n\ \ \ \ -\ \[X]\ I\ turned\ off\ my\ network\ connection\ and\ tested\ it\ while\ offline\ to\ ensure\ it\ matches\ the\ expected\ behavior\ \(i\.e\.\ verify\ the\ default\ avatar\ icon\ is\ displayed\ if\ app\ is\ offline\)\n-\ \[X]\ I\ included\ screenshots\ or\ videos\ for\ tests\ on\ \[all\ platforms]\(https:\/\/github\.com\/Expensify\/App\/blob\/main\/CONTRIBUTING\.md\#make-sure-you-can-test-on-all-platforms\)\n-\ \[X]\ I\ ran\ the\ tests\ on\ \*\*all\ platforms\*\*\ &\ verified\ they\ passed\ on:\n\ \ \ \ -\ \[X]\ iOS\ \/\ native\n\ \ \ \ -\ \[X]\ Android\ \/\ native\n\ \ \ \ -\ \[X]\ iOS\ \/\ Safari\n\ \ \ \ -\ \[X]\ Android\ \/\ Chrome\n\ \ \ \ -\ \[X]\ MacOS\ \/\ Chrome\n\ \ \ \ -\ \[X]\ MacOS\ \/\ Desktop\n-\ \[X]\ I\ verified\ there\ are\ no\ console\ errors\ \(if\ there’s\ a\ console\ error\ not\ related\ to\ the\ PR,\ report\ it\ or\ open\ an\ issue\ for\ it\ to\ be\ fixed\)\n-\ \[X]\ I\ followed\ proper\ code\ patterns\ \(see\ \[Reviewing\ the\ code]\(https:\/\/github\.com\/Expensify\/App\/blob\/main\/PR_REVIEW_GUIDELINES\.md\#reviewing-the-code\)\)\n\ \ \ \ -\ \[X]\ I\ verified\ that\ any\ callback\ methods\ that\ were\ added\ or\ modified\ are\ named\ for\ what\ the\ method\ does\ and\ never\ what\ callback\ they\ handle\ \(i\.e\.\ `toggleReport`\ and\ not\ `onIconClick`\)\n\ \ \ \ -\ \[X]\ I\ verified\ that\ comments\ were\ added\ to\ code\ that\ is\ not\ self\ explanatory\n\ \ \ \ -\ \[X]\ I\ verified\ that\ any\ new\ or\ modified\ comments\ were\ clear,\ correct\ English,\ and\ explained\ “why”\ the\ code\ was\ doing\ something\ instead\ of\ only\ explaining\ “what”\ the\ code\ was\ doing\.\n\ \ \ \ -\ \[X]\ I\ verified\ any\ copy\ \/\ text\ shown\ in\ the\ product\ was\ added\ in\ all\ `src\/languages\/\*`\ files\n\ \ \ \ -\ \[X]\ I\ verified\ any\ copy\ \/\ text\ that\ was\ added\ to\ the\ app\ is\ correct\ English\ and\ approved\ by\ marketing\ by\ tagging\ the\ marketing\ team\ on\ the\ original\ GH\ to\ get\ the\ correct\ copy\.\n\ \ \ \ -\ \[X]\ I\ verified\ proper\ file\ naming\ conventions\ were\ followed\ for\ any\ new\ files\ or\ renamed\ files\.\ All\ non-platform\ specific\ files\ are\ named\ after\ what\ they\ export\ and\ are\ not\ named\ “index\.js”\.\ All\ platform-specific\ files\ are\ named\ for\ the\ platform\ the\ code\ supports\ as\ outlined\ in\ the\ README\.\n\ \ \ \ -\ \[X]\ I\ verified\ the\ JSDocs\ style\ guidelines\ \(in\ \[`STYLE\.md`]\(https:\/\/github\.com\/Expensify\/App\/blob\/main\/STYLE\.md\#jsdocs\)\)\ were\ followed\n-\ \[X]\ If\ a\ new\ code\ pattern\ is\ added\ I\ verified\ it\ was\ agreed\ to\ be\ used\ by\ multiple\ Expensify\ engineers\n-\ \[X]\ I\ followed\ the\ guidelines\ as\ stated\ in\ the\ \[Review\ Guidelines]\(https:\/\/github\.com\/Expensify\/App\/blob\/main\/PR_REVIEW_GUIDELINES\.md\)\n-\ \[X]\ I\ tested\ other\ components\ that\ can\ be\ impacted\ by\ my\ changes\ \(i\.e\.\ if\ the\ PR\ modifies\ a\ shared\ library\ or\ component\ like\ `Avatar`,\ I\ verified\ the\ components\ using\ `Avatar`\ are\ working\ as\ expected\)\n-\ \[X]\ I\ verified\ all\ code\ is\ DRY\ \(the\ PR\ doesn\'t\ include\ any\ logic\ written\ more\ than\ once,\ with\ the\ exception\ of\ tests\)\n-\ \[X]\ I\ verified\ any\ variables\ that\ can\ be\ defined\ as\ constants\ \(ie\.\ in\ CONST\.js\ or\ at\ the\ top\ of\ the\ file\ that\ uses\ the\ constant\)\ are\ defined\ as\ such\n-\ \[X]\ If\ a\ new\ component\ is\ created\ I\ verified\ that:\n\ \ \ \ -\ \[X]\ A\ similar\ component\ doesn\'t\ exist\ in\ the\ codebase\n\ \ \ \ -\ \[X]\ All\ props\ are\ defined\ accurately\ and\ each\ prop\ has\ a\ `\/\*\*\ comment\ above\ it\ \*\/`\n\ \ \ \ -\ \[X]\ Any\ functional\ components\ have\ the\ `displayName`\ property\n\ \ \ \ -\ \[X]\ The\ file\ is\ named\ correctly\n\ \ \ \ -\ \[X]\ The\ component\ has\ a\ clear\ name\ that\ is\ non-ambiguous\ and\ the\ purpose\ of\ the\ component\ can\ be\ inferred\ from\ the\ name\ alone\n\ \ \ \ -\ \[X]\ The\ only\ data\ being\ stored\ in\ the\ state\ is\ data\ necessary\ for\ rendering\ and\ nothing\ else\n\ \ \ \ -\ \[X]\ For\ Class\ Components,\ any\ internal\ methods\ passed\ to\ components\ event\ handlers\ are\ bound\ to\ `this`\ properly\ so\ there\ are\ no\ scoping\ issues\ \(i\.e\.\ for\ `onClick=\{this\.submit}`\ the\ method\ `this\.submit`\ should\ be\ bound\ to\ `this`\ in\ the\ constructor\)\n\ \ \ \ -\ \[X]\ Any\ internal\ methods\ bound\ to\ `this`\ are\ necessary\ to\ be\ bound\ \(i\.e\.\ avoid\ `this\.submit\ =\ this\.submit\.bind\(this\);`\ if\ `this\.submit`\ is\ never\ passed\ to\ a\ component\ event\ handler\ like\ `onClick`\)\n\ \ \ \ -\ \[X]\ All\ JSX\ used\ for\ rendering\ exists\ in\ the\ render\ method\n\ \ \ \ -\ \[X]\ The\ component\ has\ the\ minimum\ amount\ of\ code\ necessary\ for\ its\ purpose\ and\ it\ is\n-\ \[X]\ If\ a\ new\ CSS\ style\ is\ added\ I\ verified\ that:\n\ \ \ \ -\ \[X]\ A\ similar\ style\ doesn\’t\ already\ exist\n\ \ \ \ -\ \[X]\ The\ style\ can’t\ be\ created\ with\ an\ existing\ \[StyleUtils]\(https:\/\/github\.com\/Expensify\/App\/blob\/main\/src\/styles\/StyleUtils\.js\)\ function\ \(i\.e\.\ `StyleUtils\.getBackgroundAndBorderStyle\(themeColors\.componentBG`\)\n-\ \[X]\ If\ the\ PR\ modifies\ a\ generic\ component,\ I\ tested\ and\ verified\ that\ those\ changes\ do\ not\ break\ usages\ of\ that\ component\ in\ the\ rest\ of\ the\ App\ \(i\.e\.\ if\ a\ shared\ library\ or\ component\ like\ `Avatar`\ is\ modified,\ I\ verified\ that\ `Avatar`\ is\ working\ as\ expected\ in\ all\ cases\)\n-\ \[X]\ If\ the\ PR\ modifies\ a\ component\ related\ to\ any\ of\ the\ existing\ Storybook\ stories,\ I\ tested\ and\ verified\ all\ stories\ for\ that\ component\ are\ still\ working\ as\ expected\.\s*'

      - uses: actions-ecosystem/action-create-comment@v1
        if: ${{ steps.checklist.outputs.match == '' }}
        with:
          github_token: ${{ secrets.github_token }}
          body: Checklist is not complete, please make sure to check all the items!

      - name: Checklist Check
        if: ${{ steps.checklist.outputs.match == '' }}
        uses: actions/github-script@v3
        with:
          script: |
            core.setFailed('Checklist not completely filled out')
